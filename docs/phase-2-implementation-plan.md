# üèóÔ∏è ISKCON.de Phase 2 - Implementierungsplan
## Kern-Features: EventCalendar, TempleFinder & Navigation

---

## üìã √úberblick

Phase 2 der ISKCON.de Website-Erweiterung implementiert die drei Kern-Features: **EventCalendar**, **TempleFinder** und **erweiterte Navigation**. Die L√∂sung baut optimal auf der bestehenden SvelteKit + Sanity CMS + Tailwind CSS Architektur auf.

## üéØ Strategische Entscheidungen

### **EventCalendar**: Custom Svelte-L√∂sung
- **Warum**: Perfekte Integration ins spirituelle Design-System
- **Vorteil**: Volle Kontrolle, keine externen Abh√§ngigkeiten, optimale Performance
- **Features**: Monats-/Listen-Ansicht, Filtering, Lazy-Loading, Accessibility

### **TempleFinder**: Erweiterung der GermanyMap
- **Warum**: Bestehende Komponente ist bereits excellent strukturiert
- **Vorteil**: Konsistenz, bew√§hrte UX, einfache Erweiterung um √ñsterreich/Schweiz sp√§ter
- **Features**: Interaktive Marker, Such-/Filter-Funktionen, Tempel-Details

### **Navigation**: Erweiterte Dropdown-Funktionalit√§t
- **Warum**: Bestehende Mobile-Navigation ist bereits gut implementiert
- **Vorteil**: Konsistente UX, erweiterte Desktop-Features hinzuf√ºgen
- **Features**: Mega-Men√ºs, spirituelle Animationen, Accessibility

## üóÇÔ∏è Komponenten-Architektur

```mermaid
graph TD
    A[Phase 2 Implementation] --> B[EventCalendar System]
    A --> C[TempleFinder System]
    A --> D[Navigation Enhancement]
    
    B --> B1[EventCalendar.svelte]
    B --> B2[EventCard.svelte]
    B --> B3[EventFilter.svelte]
    B --> B4[EventModal.svelte]
    
    C --> C1[TempleFinder.svelte]
    C --> C2[TempleCard.svelte]
    C --> C3[TempleSearch.svelte]
    C --> C4[TempleModal.svelte]
    
    D --> D1[Navbar.svelte - Enhanced]
    D --> D2[DropdownMenu.svelte]
    D --> D3[MobileMenu.svelte - Enhanced]
    
    B1 --> E[Custom Calendar Logic]
    C1 --> F[Enhanced GermanyMap]
    D1 --> G[Desktop Dropdowns]
```

## üìÅ Dateistruktur Plan

```
src/lib/components/
‚îú‚îÄ‚îÄ sections/
‚îÇ   ‚îú‚îÄ‚îÄ EventCalendar.svelte        # ‚ú® NEU - Hauptkalender
‚îÇ   ‚îú‚îÄ‚îÄ EventCard.svelte            # ‚ú® NEU - Event-Karten
‚îÇ   ‚îú‚îÄ‚îÄ EventFilter.svelte          # ‚ú® NEU - Filter-Komponente
‚îÇ   ‚îú‚îÄ‚îÄ EventModal.svelte           # ‚ú® NEU - Event-Details Modal
‚îÇ   ‚îú‚îÄ‚îÄ TempleFinder.svelte         # ‚ú® NEU - Erweiterte Karte
‚îÇ   ‚îú‚îÄ‚îÄ TempleCard.svelte           # ‚ú® NEU - Tempel-Karten
‚îÇ   ‚îú‚îÄ‚îÄ TempleSearch.svelte         # ‚ú® NEU - Such-Funktionalit√§t
‚îÇ   ‚îú‚îÄ‚îÄ TempleModal.svelte          # ‚ú® NEU - Tempel-Details Modal
‚îÇ   ‚îî‚îÄ‚îÄ GermanyMap.svelte           # üîÑ ERWEITERT - Temple-Integration
‚îú‚îÄ‚îÄ global/
‚îÇ   ‚îú‚îÄ‚îÄ Navbar.svelte               # üîÑ ERWEITERT - Desktop Dropdowns
‚îÇ   ‚îú‚îÄ‚îÄ DropdownMenu.svelte         # ‚ú® NEU - Dropdown-Komponente
‚îÇ   ‚îî‚îÄ‚îÄ MobileMenu.svelte           # ‚ú® NEU - Enhanced Mobile Menu

src/routes/
‚îú‚îÄ‚îÄ events/
‚îÇ   ‚îú‚îÄ‚îÄ +page.svelte                # ‚ú® NEU - Events-√úbersicht
‚îÇ   ‚îî‚îÄ‚îÄ +page.server.ts             # ‚ú® NEU - Event-Queries
‚îî‚îÄ‚îÄ tempel/
    ‚îú‚îÄ‚îÄ +page.svelte                # ‚ú® NEU - Tempel-Finder
    ‚îî‚îÄ‚îÄ +page.server.ts             # ‚ú® NEU - Tempel-Queries

src/lib/sanity/
‚îî‚îÄ‚îÄ queries.ts                      # üîÑ ERWEITERT - Event/Temple Queries
```

## üé® Design-System Integration

```mermaid
graph LR
    A[Spirituelles Design] --> B[Farben]
    A --> C[Typografie]
    A --> D[Komponenten]
    
    B --> B1[spiritual-saffron]
    B --> B2[spiritual-blue]
    B --> B3[spiritual-gold]
    
    C --> C1[Crimson Text - √úberschriften]
    C --> C2[Noto Sans Devanagari - Sanskrit]
    C --> C3[Inter - Body Text]
    
    D --> D1[Elegante Hover-Effekte]
    D --> D2[Kontemplative UX]
    D --> D3[Accessibility WCAG 2.1 AA]
```

## üîÑ Implementierungs-Phasen

### **Phase 2.1: EventCalendar System** (Erste Priorit√§t)

```mermaid
sequenceDiagram
    participant U as User
    participant EC as EventCalendar
    participant EF as EventFilter
    participant EM as EventModal
    participant S as Sanity CMS
    
    U->>EC: Besucht Events-Seite
    EC->>S: L√§dt Events (mit Pagination)
    S-->>EC: Event-Daten
    EC->>EF: Rendert Filter-Optionen
    U->>EF: W√§hlt Filter (Typ, Tempel, Datum)
    EF->>EC: Aktualisiert Event-Liste
    U->>EC: Klickt auf Event
    EC->>EM: √ñffnet Event-Details
    EM->>S: L√§dt vollst√§ndige Event-Daten
    S-->>EM: Detaillierte Event-Info
```

#### Komponenten-Details:

**1. EventCalendar.svelte**
- Monats-/Listen-Ansicht Toggle
- Responsive Grid f√ºr Event-Karten
- Lazy-Loading f√ºr Performance
- Pagination f√ºr gro√üe Event-Listen
- Spirituelles Design mit saffron/blue Akzenten

**2. EventCard.svelte**
- Event-Typ Icons und Badges
- Datum/Zeit Anzeige mit spiritueller Typografie
- Tempel-Referenz mit Link
- Call-to-Action f√ºr Details/Anmeldung
- Hover-Effekte mit spiritual-gold Akzenten

**3. EventFilter.svelte**
- Multi-Select f√ºr Event-Typen (Festival, Kirtan, Vortrag, etc.)
- Tempel-Dropdown mit Autocomplete
- Datums-Range Picker
- Tags-Filter
- Reset-Funktionalit√§t
- URL-State Integration f√ºr Bookmarks

**4. EventModal.svelte**
- Vollbild-Overlay mit Event-Details
- Anmelde-Integration (Registration-Link)
- Kontakt-Informationen des Veranstalters
- Wegbeschreibung zu Tempel/Veranstaltungsort
- Social Sharing (WhatsApp, Email, etc.)
- Accessibility-konform (ESC-close, Focus-trap)

### **Phase 2.2: TempleFinder System** (Zweite Priorit√§t)

```mermaid
sequenceDiagram
    participant U as User
    participant TF as TempleFinder
    participant GM as GermanyMap
    participant TS as TempleSearch
    participant TM as TempleModal
    participant S as Sanity CMS
    
    U->>TF: Besucht Tempel-Seite
    TF->>S: L√§dt alle Tempel
    S-->>TF: Tempel-Daten mit Koordinaten
    TF->>GM: Rendert Karte mit Tempel-Markern
    U->>TS: Sucht nach Standort/Services
    TS->>TF: Filtert Tempel-Liste
    U->>GM: Klickt auf Tempel-Marker
    GM->>TM: √ñffnet Tempel-Details
    TM->>S: L√§dt vollst√§ndige Tempel-Info
    S-->>TM: Detaillierte Tempel-Daten
```

#### Komponenten-Details:

**1. TempleFinder.svelte**
- Integration der erweiterten GermanyMap
- Such-/Filter-Sidebar
- Tempel-Liste parallel zur Karte
- Responsive Layout (Karte oben auf Mobile)
- Spirituelle Gestaltung mit earth-T√∂nen

**2. Enhanced GermanyMap.svelte**
- Tempel-spezifische Marker (Lotus-Icons in spiritual-saffron)
- Hover-Effekte mit Tempel-Preview
- Clustering f√ºr dichte Bereiche
- Zoom-to-fit Funktionalit√§t
- Performance-optimiert f√ºr viele Marker

**3. TempleSearch.svelte**
- Geografische Suche (PLZ, Stadt, Umkreis)
- Service-Filter (Restaurant, Bibliothek, G√§stehaus, etc.)
- Entfernungs-basierte Sortierung
- √ñffnungszeiten-Filter ("Jetzt ge√∂ffnet")
- Accessibility-konforme Formular-Elemente

**4. TempleCard.svelte**
- Tempel-Foto mit spirituellem Rahmen
- Grundinformationen (Name, Stadt, Services)
- √ñffnungszeiten-Anzeige (heute hervorgehoben)
- Service-Icons in spiritual-blue
- Entfernung (wenn Standort verf√ºgbar)
- Direkter Link zu Details und Wegbeschreibung

**5. TempleModal.svelte**
- Vollst√§ndige Tempel-Information
- Bildergalerie mit Lightbox
- Programme und √ñffnungszeiten-Tabelle
- Kontakt und Wegbeschreibung
- Aktuelle Events im Tempel
- Social Media Links
- Google Maps Integration

### **Phase 2.3: Navigation Enhancement** (Dritte Priorit√§t)

#### Erweiterte Navigation-Features:

**1. Enhanced Navbar.svelte**
- Desktop-Dropdown-Men√ºs hinzuf√ºgen
- Mega-Menu f√ºr "Tempel & Zentren" mit Karten-Preview
- Events-Dropdown mit Featured Events
- Bessere Accessibility (ARIA-Labels, Keyboard-Navigation)
- Spiritual Hover-Animationen mit saffron-Akzenten
- Sticky-Navigation mit Scroll-Detection

**2. DropdownMenu.svelte**
- Spirituelle Dropdown-Gestaltung
- Smooth Animations (fade + slide)
- Multi-Level-Support
- Keyboard-Navigation (Arrow-Keys, Enter, ESC)
- Auto-close auf au√üen-Klick
- Mobile-responsive Fallback

**3. Enhanced MobileMenu.svelte**
- Events & Tempel Integration in bestehende Struktur
- Schnell-Zugriff auf Filter
- Spirituelle Navigation-Icons
- Improved Touch-Gestures
- Better Performance (Virtual Scrolling bei langen Listen)

## üîç Sanity Queries Erweiterungen

```typescript
// Event Queries
export const eventQueries = {
  // Alle Events mit Filtering
  getAllEvents: `*[_type == "event" && isPublished == true] | order(startDate asc) {
    title,
    'slug': slug.current,
    description,
    startDate,
    endDate,
    eventType,
    'featuredImage': featuredImage.asset->url,
    'temple': location.temple-> {
      name,
      'slug': slug.current,
      'address': address
    },
    isFeatured,
    tags,
    registration {
      required,
      deadline,
      registrationLink,
      cost
    }
  }`,
  
  // Events f√ºr Kalender (mit Recurrence)
  getCalendarEvents: `*[_type == "event" && isPublished == true && startDate >= now()] {
    title,
    startDate,
    endDate,
    eventType,
    isRecurring,
    recurrencePattern,
    'temple': location.temple->name,
    'color': eventType
  }[0...100]`,
  
  // Featured Events f√ºr Homepage
  getFeaturedEvents: `*[_type == "event" && isFeatured == true && isPublished == true && startDate >= now()] | order(startDate asc)[0...6] {
    title,
    'slug': slug.current,
    startDate,
    eventType,
    'featuredImage': featuredImage.asset->url,
    'temple': location.temple->name
  }`,

  // Event Details
  getEventBySlug: `*[_type == "event" && slug.current == $slug][0] {
    title,
    description,
    longDescription,
    'featuredImage': featuredImage.asset->url,
    startDate,
    endDate,
    eventType,
    location,
    organizer,
    registration,
    tags,
    seo
  }`
};

// Temple Queries  
export const templeQueries = {
  // Alle aktiven Tempel f√ºr Karte
  getAllTemples: `*[_type == "temple" && isActive == true] | order(name asc) {
    name,
    'slug': slug.current,
    description,
    'mainImage': mainImage.asset->url,
    address,
    location,
    contact,
    serviceHours,
    facilities,
    featuredOnHomepage,
    programs[] {
      title,
      time,
      frequency
    }
  }`,
  
  // Tempel-Details
  getTempleBySlug: `*[_type == "temple" && slug.current == $slug][0] {
    name,
    description,
    'mainImage': mainImage.asset->url,
    'gallery': gallery[].asset->url,
    address,
    location,
    contact,
    serviceHours,
    programs,
    facilities,
    president,
    seo
  }`,

  // Featured Tempel f√ºr Homepage
  getFeaturedTemples: `*[_type == "temple" && featuredOnHomepage == true && isActive == true][0...4] {
    name,
    'slug': slug.current,
    'mainImage': mainImage.asset->url,
    'city': address.city,
    facilities
  }`
};

// Navigation Queries
export const navigationQueries = {
  // Events f√ºr Navigation
  getNavEvents: `*[_type == "event" && isFeatured == true && startDate >= now()] | order(startDate asc)[0...3] {
    title,
    'slug': slug.current,
    startDate,
    eventType
  }`,
  
  // Tempel f√ºr Navigation
  getNavTemples: `*[_type == "temple" && featuredOnHomepage == true] | order(name asc)[0...5] {
    name,
    'slug': slug.current,
    'city': address.city
  }`
};
```

## üéØ Technische Implementierungs-Details

### **Performance-Optimierungen:**
- **Lazy Loading**: Events und Tempel-Daten mit Intersection Observer
- **Image Optimization**: Sanity CDN mit responsiven Breakpoints
- **Code Splitting**: Route-basierte Komponenten-Trennung
- **Caching**: Server-side Queries mit SvelteKit Load Functions
- **Virtual Scrolling**: F√ºr gro√üe Event-/Tempel-Listen
- **Preloading**: Critical Resources mit rel="preload"

### **Accessibility (WCAG 2.1 AA):**
- **Keyboard Navigation**: Alle interaktiven Elemente erreichbar
- **Screen Reader**: Semantische HTML-Struktur und ARIA-Labels
- **Color Contrast**: Spirituelle Farben mit mindestens 4.5:1 Kontrast
- **Focus Management**: Sichtbare Focus-Indikatoren in spiritual-saffron
- **Alternative Text**: F√ºr alle Bilder und Icons
- **Skip Links**: F√ºr Haupt-Navigation

### **Mobile-First Design:**
- **Responsive Breakpoints**: Tailwind CSS System (sm:, md:, lg:, xl:)
- **Touch-Optimized**: Mindestens 44px Touch-Targets
- **Performance**: Optimiert f√ºr langsamere Verbindungen
- **Gestures**: Swipe-Navigation f√ºr Kalender und Gallerien
- **Viewport**: Optimiert f√ºr verschiedene Bildschirmgr√∂√üen

### **Spirituelles Design-System:**
- **Farben**: Konsequente Verwendung von spiritual-saffron/blue/gold
- **Typografie**: Sanskrit-freundliche Schriften (Noto Sans Devanagari)
- **Animationen**: Sanfte, kontemplative √úberg√§nge
- **Icons**: Spirituelle Symbolik (Lotus, Om, etc.)
- **Layout**: Harmonische Proportionen und Wei√üraum

## üöÄ Rollout-Strategie

### **Woche 1-2: Phase 2.1 - EventCalendar System**
1. EventCalendar.svelte - Grundstruktur und Kalender-Logic
2. EventCard.svelte - Spirituelles Card-Design
3. EventFilter.svelte - Filtering und URL-State
4. EventModal.svelte - Detail-Ansicht und Accessibility
5. Events-Route (/events) - Server-side Queries
6. Sanity Queries - Event-spezifische Abfragen

### **Woche 3-4: Phase 2.2 - TempleFinder System**
1. TempleFinder.svelte - Haupt-Container und Layout
2. Enhanced GermanyMap.svelte - Tempel-Marker Integration
3. TempleSearch.svelte - Such- und Filter-Funktionalit√§t
4. TempleCard.svelte - Tempel-Karten Design
5. TempleModal.svelte - Detail-Ansicht mit Maps-Integration
6. Tempel-Route (/tempel) - Server-side Queries

### **Woche 5: Phase 2.3 - Navigation Enhancement**
1. Enhanced Navbar.svelte - Desktop-Dropdowns
2. DropdownMenu.svelte - Wiederverwendbare Dropdown-Komponente
3. Enhanced MobileMenu.svelte - Mobile Verbesserungen
4. Navigation-Integration - Events/Tempel in Men√ºs
5. Accessibility-Testing - Keyboard und Screen Reader

### **Woche 6: Testing & Refinement**
1. Cross-Browser Testing (Chrome, Firefox, Safari, Edge)
2. Mobile Device Testing (iOS, Android)
3. Performance Optimization (Lighthouse Scores)
4. Accessibility Audit (WCAG 2.1 AA)
5. User Experience Testing
6. Bug Fixes und Final Polish

## üîÑ Integration mit bestehenden Features

### **Homepage Integration:**
- Featured Events in bestehenden Slider
- Featured Tempel in Deutschland-Karte
- Navigation-Updates f√ºr neue Routen

### **SEO Optimierung:**
- Meta-Tags f√ºr Event- und Tempel-Seiten
- Structured Data (JSON-LD) f√ºr Events
- Sitemap-Updates
- Open Graph Tags f√ºr Social Sharing

### **Analytics Integration:**
- Event-Tracking f√ºr Kalender-Interaktionen
- Tempel-Suche Analytics
- Navigation-Nutzung Tracking
- Conversion-Tracking f√ºr Event-Anmeldungen

---

## ‚úÖ Erfolgskriterien

### **Funktionale Kriterien:**
- ‚úÖ Events k√∂nnen nach Typ, Datum, Tempel gefiltert werden
- ‚úÖ Kalender zeigt Events in Monats- und Listen-Ansicht
- ‚úÖ Tempel k√∂nnen geographisch gesucht und gefiltert werden
- ‚úÖ Karte zeigt alle Tempel mit interaktiven Markern
- ‚úÖ Navigation ist intuitiv und accessibility-konform
- ‚úÖ Mobile Nutzererfahrung ist optimiert

### **Technische Kriterien:**
- ‚úÖ Lighthouse Score > 90 (Performance, Accessibility, SEO)
- ‚úÖ WCAG 2.1 AA Compliance
- ‚úÖ Responsive Design funktioniert auf allen Ger√§ten
- ‚úÖ Keine JavaScript-Fehler in Browser-Konsole
- ‚úÖ Fast Loading Times (< 3s auf 3G)

### **Design Kriterien:**
- ‚úÖ Konsistente Verwendung des spirituellen Design-Systems
- ‚úÖ Harmonische Integration in bestehende Website
- ‚úÖ Intuitive Benutzerf√ºhrung
- ‚úÖ √Ñsthetisch ansprechende Darstellung

---

*Dieser Plan bildet die Grundlage f√ºr die Implementierung der Phase 2 Kern-Features der ISKCON.de Website. Alle Komponenten werden mit spiritueller √Ñsthetik, Performance-Optimierung und Accessibility im Fokus entwickelt.*